!function(){function a(a){return m.call(a)}function b(a,b,c){try{j.call(a,b,c)}catch(d){}}function c(a,b){k.call(a,b)}function d(a){return n.call(a)}function e(a){for(;a.childNodes.length;)a.removeChild(a.lastChild)}function f(a,b,c){l.value.call(a,b,c)}function g(){var a=!0;try{o.innerHTML="<test/>"}catch(b){a=!1}return a}function h(g,h){function i(e){var f=a(e);if(f&&f.length){for(var g,h=0,j=f.length;j>h;h++){var k=f[h],l=k.name;"o"!==l[0]&&"O"!==l[0]||"n"!==l[1]&&"N"!==l[1]||(g=g||[],g.push({name:k.name,value:k.value}))}if(g)for(var h=0,j=g.length;j>h;h++){var k=g[h];c(e,k.name),b(e,"x-"+k.name,k.value)}}for(var m=d(e),h=0,j=m.length;j>h;h++)i(m[h])}var j=document.implementation.createHTMLDocument("cleaner");e(j.documentElement),MSApp.execUnsafeLocalFunction(function(){f(j.documentElement,"afterbegin",g)});var k=j.documentElement.querySelectorAll("script");Array.prototype.forEach.call(k,function(a){switch(a.type.toLowerCase()){case"":a.type="text/inert";break;case"text/javascript":case"text/ecmascript":case"text/x-javascript":case"text/jscript":case"text/livescript":case"text/javascript1.1":case"text/javascript1.2":case"text/javascript1.3":a.type="text/inert-"+a.type.slice("text/".length);break;case"application/javascript":case"application/ecmascript":case"application/x-javascript":a.type="application/inert-"+a.type.slice("application/".length)}}),i(j.documentElement);var l=[];return"HTML"===h.tagName?l=Array.prototype.slice.call(document.adoptNode(j.documentElement).childNodes):(j.head&&(l=l.concat(Array.prototype.slice.call(document.adoptNode(j.head).childNodes))),j.body&&(l=l.concat(Array.prototype.slice.call(document.adoptNode(j.body).childNodes)))),l}function i(a,b){var c=Object.getOwnPropertyDescriptor(HTMLElement.prototype,a),d=c.set;Object.defineProperty(HTMLElement.prototype,a,{get:c.get,set:function(a){if(window.WinJS&&window.WinJS._execUnsafe&&g())d.call(this,a);else{var e=this,f=h(a,e);MSApp.execUnsafeLocalFunction(function(){b(c,e,f)})}},enumerable:c.enumerable,configurable:c.configurable})}if(window.MSApp&&MSApp.execUnsafeLocalFunction){var j=Object.getOwnPropertyDescriptor(Element.prototype,"setAttribute").value,k=Object.getOwnPropertyDescriptor(Element.prototype,"removeAttribute").value,l=Object.getOwnPropertyDescriptor(HTMLElement.prototype,"insertAdjacentHTML"),m=Object.getOwnPropertyDescriptor(Node.prototype,"attributes").get,n=Object.getOwnPropertyDescriptor(Node.prototype,"childNodes").get,o=document.createElement("div");i("innerHTML",function(a,b,c){e(b);for(var d=0,f=c.length;f>d;d++)b.appendChild(c[d])}),i("outerHTML",function(a,b,c){for(var d=0,e=c.length;e>d;d++)b.insertAdjacentElement("afterend",c[d]);b.parentNode.removeChild(b)})}}();