<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>App/DogTool/bower_components/angular-sanitize/angular-sanitize.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Address.html">Address</a></li>
                                <li><a href="../classes/Business_info.html">Business_info</a></li>
                                <li><a href="../classes/Calendar.html">Calendar</a></li>
                                <li><a href="../classes/Charge.html">Charge</a></li>
                                <li><a href="../classes/Consultation.html">Consultation</a></li>
                                <li><a href="../classes/Cost.html">Cost</a></li>
                                <li><a href="../classes/Daycare.html">Daycare</a></li>
                                <li><a href="../classes/Dog.html">Dog</a></li>
                                <li><a href="../classes/dogToolApp.html">dogToolApp</a></li>
                                <li><a href="../classes/FactoryDog.html">FactoryDog</a></li>
                                <li><a href="../classes/Homework.html">Homework</a></li>
                                <li><a href="../classes/Invoice.html">Invoice</a></li>
                                <li><a href="../classes/Note.html">Note</a></li>
                                <li><a href="../classes/Note_Type.html">Note_Type</a></li>
                                <li><a href="../classes/People.html">People</a></li>
                                <li><a href="../classes/People_type.html">People_type</a></li>
                                <li><a href="../classes/Service.html">Service</a></li>
                                <li><a href="../classes/Weight.html">Weight</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/:: Policy.html">:: Policy</a></li>
                                <li><a href="../modules/ng.html">ng</a></li>
                                <li><a href="../modules/ngMock.html">ngMock</a></li>
                                <li><a href="../modules/ngMockE2E.html">ngMockE2E</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: App/DogTool/bower_components/angular-sanitize/angular-sanitize.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @license AngularJS v1.3.13
 * (c) 2010-2014 Google, Inc. http://angularjs.org
 * License: MIT
 */
(function(window, angular, undefined) {&#x27;use strict&#x27;;

var $sanitizeMinErr = angular.$$minErr(&#x27;$sanitize&#x27;);

/**
 * @ngdoc module
 * @name ngSanitize
 * @description
 *
 * # ngSanitize
 *
 * The &#x60;ngSanitize&#x60; module provides functionality to sanitize HTML.
 *
 *
 * &lt;div doc-module-components=&quot;ngSanitize&quot;&gt;&lt;/div&gt;
 *
 * See {@link ngSanitize.$sanitize &#x60;$sanitize&#x60;} for usage.
 */

/*
 * HTML Parser By Misko Hevery (misko@hevery.com)
 * based on:  HTML Parser By John Resig (ejohn.org)
 * Original code by Erik Arvidsson, Mozilla Public License
 * http://erik.eae.net/simplehtmlparser/simplehtmlparser.js
 *
 * // Use like so:
 * htmlParser(htmlString, {
 *     start: function(tag, attrs, unary) {},
 *     end: function(tag) {},
 *     chars: function(text) {},
 *     comment: function(text) {}
 * });
 *
 */


/**
 * @ngdoc service
 * @name $sanitize
 * @kind function
 *
 * @description
 *   The input is sanitized by parsing the HTML into tokens. All safe tokens (from a whitelist) are
 *   then serialized back to properly escaped html string. This means that no unsafe input can make
 *   it into the returned string, however, since our parser is more strict than a typical browser
 *   parser, it&#x27;s possible that some obscure input, which would be recognized as valid HTML by a
 *   browser, won&#x27;t make it through the sanitizer. The input may also contain SVG markup.
 *   The whitelist is configured using the functions &#x60;aHrefSanitizationWhitelist&#x60; and
 *   &#x60;imgSrcSanitizationWhitelist&#x60; of {@link ng.$compileProvider &#x60;$compileProvider&#x60;}.
 *
 * @param {string} html HTML input.
 * @returns {string} Sanitized HTML.
 *
 * @example
   &lt;example module=&quot;sanitizeExample&quot; deps=&quot;angular-sanitize.js&quot;&gt;
   &lt;file name=&quot;index.html&quot;&gt;
     &lt;script&gt;
         angular.module(&#x27;sanitizeExample&#x27;, [&#x27;ngSanitize&#x27;])
           .controller(&#x27;ExampleController&#x27;, [&#x27;$scope&#x27;, &#x27;$sce&#x27;, function($scope, $sce) {
             $scope.snippet =
               &#x27;&lt;p style=&quot;color:blue&quot;&gt;an html\n&#x27; +
               &#x27;&lt;em onmouseover=&quot;this.textContent=\&#x27;PWN3D!\&#x27;&quot;&gt;click here&lt;/em&gt;\n&#x27; +
               &#x27;snippet&lt;/p&gt;&#x27;;
             $scope.deliberatelyTrustDangerousSnippet = function() {
               return $sce.trustAsHtml($scope.snippet);
             };
           }]);
     &lt;/script&gt;
     &lt;div ng-controller=&quot;ExampleController&quot;&gt;
        Snippet: &lt;textarea ng-model=&quot;snippet&quot; cols=&quot;60&quot; rows=&quot;3&quot;&gt;&lt;/textarea&gt;
       &lt;table&gt;
         &lt;tr&gt;
           &lt;td&gt;Directive&lt;/td&gt;
           &lt;td&gt;How&lt;/td&gt;
           &lt;td&gt;Source&lt;/td&gt;
           &lt;td&gt;Rendered&lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;bind-html-with-sanitize&quot;&gt;
           &lt;td&gt;ng-bind-html&lt;/td&gt;
           &lt;td&gt;Automatically uses $sanitize&lt;/td&gt;
           &lt;td&gt;&lt;pre&gt;&amp;lt;div ng-bind-html=&quot;snippet&quot;&amp;gt;&lt;br/&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;&lt;/td&gt;
           &lt;td&gt;&lt;div ng-bind-html=&quot;snippet&quot;&gt;&lt;/div&gt;&lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;bind-html-with-trust&quot;&gt;
           &lt;td&gt;ng-bind-html&lt;/td&gt;
           &lt;td&gt;Bypass $sanitize by explicitly trusting the dangerous value&lt;/td&gt;
           &lt;td&gt;
           &lt;pre&gt;&amp;lt;div ng-bind-html=&quot;deliberatelyTrustDangerousSnippet()&quot;&amp;gt;
&amp;lt;/div&amp;gt;&lt;/pre&gt;
           &lt;/td&gt;
           &lt;td&gt;&lt;div ng-bind-html=&quot;deliberatelyTrustDangerousSnippet()&quot;&gt;&lt;/div&gt;&lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;bind-default&quot;&gt;
           &lt;td&gt;ng-bind&lt;/td&gt;
           &lt;td&gt;Automatically escapes&lt;/td&gt;
           &lt;td&gt;&lt;pre&gt;&amp;lt;div ng-bind=&quot;snippet&quot;&amp;gt;&lt;br/&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;&lt;/td&gt;
           &lt;td&gt;&lt;div ng-bind=&quot;snippet&quot;&gt;&lt;/div&gt;&lt;/td&gt;
         &lt;/tr&gt;
       &lt;/table&gt;
       &lt;/div&gt;
   &lt;/file&gt;
   &lt;file name=&quot;protractor.js&quot; type=&quot;protractor&quot;&gt;
     it(&#x27;should sanitize the html snippet by default&#x27;, function() {
       expect(element(by.css(&#x27;#bind-html-with-sanitize div&#x27;)).getInnerHtml()).
         toBe(&#x27;&lt;p&gt;an html\n&lt;em&gt;click here&lt;/em&gt;\nsnippet&lt;/p&gt;&#x27;);
     });

     it(&#x27;should inline raw snippet if bound to a trusted value&#x27;, function() {
       expect(element(by.css(&#x27;#bind-html-with-trust div&#x27;)).getInnerHtml()).
         toBe(&quot;&lt;p style=\&quot;color:blue\&quot;&gt;an html\n&quot; +
              &quot;&lt;em onmouseover=\&quot;this.textContent=&#x27;PWN3D!&#x27;\&quot;&gt;click here&lt;/em&gt;\n&quot; +
              &quot;snippet&lt;/p&gt;&quot;);
     });

     it(&#x27;should escape snippet without any filter&#x27;, function() {
       expect(element(by.css(&#x27;#bind-default div&#x27;)).getInnerHtml()).
         toBe(&quot;&amp;lt;p style=\&quot;color:blue\&quot;&amp;gt;an html\n&quot; +
              &quot;&amp;lt;em onmouseover=\&quot;this.textContent=&#x27;PWN3D!&#x27;\&quot;&amp;gt;click here&amp;lt;/em&amp;gt;\n&quot; +
              &quot;snippet&amp;lt;/p&amp;gt;&quot;);
     });

     it(&#x27;should update&#x27;, function() {
       element(by.model(&#x27;snippet&#x27;)).clear();
       element(by.model(&#x27;snippet&#x27;)).sendKeys(&#x27;new &lt;b onclick=&quot;alert(1)&quot;&gt;text&lt;/b&gt;&#x27;);
       expect(element(by.css(&#x27;#bind-html-with-sanitize div&#x27;)).getInnerHtml()).
         toBe(&#x27;new &lt;b&gt;text&lt;/b&gt;&#x27;);
       expect(element(by.css(&#x27;#bind-html-with-trust div&#x27;)).getInnerHtml()).toBe(
         &#x27;new &lt;b onclick=&quot;alert(1)&quot;&gt;text&lt;/b&gt;&#x27;);
       expect(element(by.css(&#x27;#bind-default div&#x27;)).getInnerHtml()).toBe(
         &quot;new &amp;lt;b onclick=\&quot;alert(1)\&quot;&amp;gt;text&amp;lt;/b&amp;gt;&quot;);
     });
   &lt;/file&gt;
   &lt;/example&gt;
 */
function $SanitizeProvider() {
  this.$get = [&#x27;$$sanitizeUri&#x27;, function($$sanitizeUri) {
    return function(html) {
      var buf = [];
      htmlParser(html, htmlSanitizeWriter(buf, function(uri, isImage) {
        return !/^unsafe/.test($$sanitizeUri(uri, isImage));
      }));
      return buf.join(&#x27;&#x27;);
    };
  }];
}

function sanitizeText(chars) {
  var buf = [];
  var writer = htmlSanitizeWriter(buf, angular.noop);
  writer.chars(chars);
  return buf.join(&#x27;&#x27;);
}


// Regular Expressions for parsing tags and attributes
var START_TAG_REGEXP =
       /^&lt;((?:[a-zA-Z])[\w:-]*)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:&quot;[^&quot;]*&quot;)|(?:&#x27;[^&#x27;]*&#x27;)|[^&gt;\s]+))?)*)\s*(\/?)\s*(&gt;?)/,
  END_TAG_REGEXP = /^&lt;\/\s*([\w:-]+)[^&gt;]*&gt;/,
  ATTR_REGEXP = /([\w:-]+)(?:\s*=\s*(?:(?:&quot;((?:[^&quot;])*)&quot;)|(?:&#x27;((?:[^&#x27;])*)&#x27;)|([^&gt;\s]+)))?/g,
  BEGIN_TAG_REGEXP = /^&lt;/,
  BEGING_END_TAGE_REGEXP = /^&lt;\//,
  COMMENT_REGEXP = /&lt;!--(.*?)--&gt;/g,
  DOCTYPE_REGEXP = /&lt;!DOCTYPE([^&gt;]*?)&gt;/i,
  CDATA_REGEXP = /&lt;!\[CDATA\[(.*?)]]&gt;/g,
  SURROGATE_PAIR_REGEXP = /[\uD800-\uDBFF][\uDC00-\uDFFF]/g,
  // Match everything outside of normal chars and &quot; (quote character)
  NON_ALPHANUMERIC_REGEXP = /([^\#-~| |!])/g;


// Good source of info about elements and attributes
// http://dev.w3.org/html5/spec/Overview.html#semantics
// http://simon.html5.org/html-elements

// Safe Void Elements - HTML5
// http://dev.w3.org/html5/spec/Overview.html#void-elements
var voidElements = makeMap(&quot;area,br,col,hr,img,wbr&quot;);

// Elements that you can, intentionally, leave open (and which close themselves)
// http://dev.w3.org/html5/spec/Overview.html#optional-tags
var optionalEndTagBlockElements = makeMap(&quot;colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr&quot;),
    optionalEndTagInlineElements = makeMap(&quot;rp,rt&quot;),
    optionalEndTagElements = angular.extend({},
                                            optionalEndTagInlineElements,
                                            optionalEndTagBlockElements);

// Safe Block Elements - HTML5
var blockElements = angular.extend({}, optionalEndTagBlockElements, makeMap(&quot;address,article,&quot; +
        &quot;aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,&quot; +
        &quot;h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul&quot;));

// Inline Elements - HTML5
var inlineElements = angular.extend({}, optionalEndTagInlineElements, makeMap(&quot;a,abbr,acronym,b,&quot; +
        &quot;bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,&quot; +
        &quot;samp,small,span,strike,strong,sub,sup,time,tt,u,var&quot;));

// SVG Elements
// https://wiki.whatwg.org/wiki/Sanitization_rules#svg_Elements
var svgElements = makeMap(&quot;animate,animateColor,animateMotion,animateTransform,circle,defs,&quot; +
        &quot;desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,&quot; +
        &quot;line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,set,&quot; +
        &quot;stop,svg,switch,text,title,tspan,use&quot;);

// Special Elements (can contain anything)
var specialElements = makeMap(&quot;script,style&quot;);

var validElements = angular.extend({},
                                   voidElements,
                                   blockElements,
                                   inlineElements,
                                   optionalEndTagElements,
                                   svgElements);

//Attributes that have href and hence need to be sanitized
var uriAttrs = makeMap(&quot;background,cite,href,longdesc,src,usemap,xlink:href&quot;);

var htmlAttrs = makeMap(&#x27;abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,&#x27; +
    &#x27;color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,&#x27; +
    &#x27;ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,&#x27; +
    &#x27;scope,scrolling,shape,size,span,start,summary,target,title,type,&#x27; +
    &#x27;valign,value,vspace,width&#x27;);

// SVG attributes (without &quot;id&quot; and &quot;name&quot; attributes)
// https://wiki.whatwg.org/wiki/Sanitization_rules#svg_Attributes
var svgAttrs = makeMap(&#x27;accent-height,accumulate,additive,alphabetic,arabic-form,ascent,&#x27; +
    &#x27;attributeName,attributeType,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,&#x27; +
    &#x27;color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,&#x27; +
    &#x27;font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,&#x27; +
    &#x27;gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,&#x27; +
    &#x27;keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,&#x27; +
    &#x27;markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,&#x27; +
    &#x27;overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,&#x27; +
    &#x27;repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,&#x27; +
    &#x27;stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,&#x27; +
    &#x27;stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,&#x27; +
    &#x27;stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,&#x27; +
    &#x27;underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,&#x27; +
    &#x27;viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,&#x27; +
    &#x27;xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,&#x27; +
    &#x27;zoomAndPan&#x27;);

var validAttrs = angular.extend({},
                                uriAttrs,
                                svgAttrs,
                                htmlAttrs);

function makeMap(str) {
  var obj = {}, items = str.split(&#x27;,&#x27;), i;
  for (i = 0; i &lt; items.length; i++) obj[items[i]] = true;
  return obj;
}


/**
 * @example
 * htmlParser(htmlString, {
 *     start: function(tag, attrs, unary) {},
 *     end: function(tag) {},
 *     chars: function(text) {},
 *     comment: function(text) {}
 * });
 *
 * @param {string} html string
 * @param {object} handler
 */
function htmlParser(html, handler) {
  if (typeof html !== &#x27;string&#x27;) {
    if (html === null || typeof html === &#x27;undefined&#x27;) {
      html = &#x27;&#x27;;
    } else {
      html = &#x27;&#x27; + html;
    }
  }
  var index, chars, match, stack = [], last = html, text;
  stack.last = function() { return stack[stack.length - 1]; };

  while (html) {
    text = &#x27;&#x27;;
    chars = true;

    // Make sure we&#x27;re not in a script or style element
    if (!stack.last() || !specialElements[stack.last()]) {

      // Comment
      if (html.indexOf(&quot;&lt;!--&quot;) === 0) {
        // comments containing -- are not allowed unless they terminate the comment
        index = html.indexOf(&quot;--&quot;, 4);

        if (index &gt;= 0 &amp;&amp; html.lastIndexOf(&quot;--&gt;&quot;, index) === index) {
          if (handler.comment) handler.comment(html.substring(4, index));
          html = html.substring(index + 3);
          chars = false;
        }
      // DOCTYPE
      } else if (DOCTYPE_REGEXP.test(html)) {
        match = html.match(DOCTYPE_REGEXP);

        if (match) {
          html = html.replace(match[0], &#x27;&#x27;);
          chars = false;
        }
      // end tag
      } else if (BEGING_END_TAGE_REGEXP.test(html)) {
        match = html.match(END_TAG_REGEXP);

        if (match) {
          html = html.substring(match[0].length);
          match[0].replace(END_TAG_REGEXP, parseEndTag);
          chars = false;
        }

      // start tag
      } else if (BEGIN_TAG_REGEXP.test(html)) {
        match = html.match(START_TAG_REGEXP);

        if (match) {
          // We only have a valid start-tag if there is a &#x27;&gt;&#x27;.
          if (match[4]) {
            html = html.substring(match[0].length);
            match[0].replace(START_TAG_REGEXP, parseStartTag);
          }
          chars = false;
        } else {
          // no ending tag found --- this piece should be encoded as an entity.
          text += &#x27;&lt;&#x27;;
          html = html.substring(1);
        }
      }

      if (chars) {
        index = html.indexOf(&quot;&lt;&quot;);

        text += index &lt; 0 ? html : html.substring(0, index);
        html = index &lt; 0 ? &quot;&quot; : html.substring(index);

        if (handler.chars) handler.chars(decodeEntities(text));
      }

    } else {
      // IE versions 9 and 10 do not understand the regex &#x27;[^]&#x27;, so using a workaround with [\W\w].
      html = html.replace(new RegExp(&quot;([\\W\\w]*)&lt;\\s*\\/\\s*&quot; + stack.last() + &quot;[^&gt;]*&gt;&quot;, &#x27;i&#x27;),
        function(all, text) {
          text = text.replace(COMMENT_REGEXP, &quot;$1&quot;).replace(CDATA_REGEXP, &quot;$1&quot;);

          if (handler.chars) handler.chars(decodeEntities(text));

          return &quot;&quot;;
      });

      parseEndTag(&quot;&quot;, stack.last());
    }

    if (html == last) {
      throw $sanitizeMinErr(&#x27;badparse&#x27;, &quot;The sanitizer was unable to parse the following block &quot; +
                                        &quot;of html: {0}&quot;, html);
    }
    last = html;
  }

  // Clean up any remaining tags
  parseEndTag();

  function parseStartTag(tag, tagName, rest, unary) {
    tagName = angular.lowercase(tagName);
    if (blockElements[tagName]) {
      while (stack.last() &amp;&amp; inlineElements[stack.last()]) {
        parseEndTag(&quot;&quot;, stack.last());
      }
    }

    if (optionalEndTagElements[tagName] &amp;&amp; stack.last() == tagName) {
      parseEndTag(&quot;&quot;, tagName);
    }

    unary = voidElements[tagName] || !!unary;

    if (!unary)
      stack.push(tagName);

    var attrs = {};

    rest.replace(ATTR_REGEXP,
      function(match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {
        var value = doubleQuotedValue
          || singleQuotedValue
          || unquotedValue
          || &#x27;&#x27;;

        attrs[name] = decodeEntities(value);
    });
    if (handler.start) handler.start(tagName, attrs, unary);
  }

  function parseEndTag(tag, tagName) {
    var pos = 0, i;
    tagName = angular.lowercase(tagName);
    if (tagName)
      // Find the closest opened tag of the same type
      for (pos = stack.length - 1; pos &gt;= 0; pos--)
        if (stack[pos] == tagName)
          break;

    if (pos &gt;= 0) {
      // Close all the open elements, up the stack
      for (i = stack.length - 1; i &gt;= pos; i--)
        if (handler.end) handler.end(stack[i]);

      // Remove the open elements from the stack
      stack.length = pos;
    }
  }
}

var hiddenPre=document.createElement(&quot;pre&quot;);
var spaceRe = /^(\s*)([\s\S]*?)(\s*)$/;
/**
 * decodes all entities into regular string
 * @param value
 * @returns {string} A string with decoded entities.
 */
function decodeEntities(value) {
  if (!value) { return &#x27;&#x27;; }

  // Note: IE8 does not preserve spaces at the start/end of innerHTML
  // so we must capture them and reattach them afterward
  var parts = spaceRe.exec(value);
  var spaceBefore = parts[1];
  var spaceAfter = parts[3];
  var content = parts[2];
  if (content) {
    hiddenPre.innerHTML=content.replace(/&lt;/g,&quot;&amp;lt;&quot;);
    // innerText depends on styling as it doesn&#x27;t display hidden elements.
    // Therefore, it&#x27;s better to use textContent not to cause unnecessary
    // reflows. However, IE&lt;9 don&#x27;t support textContent so the innerText
    // fallback is necessary.
    content = &#x27;textContent&#x27; in hiddenPre ?
      hiddenPre.textContent : hiddenPre.innerText;
  }
  return spaceBefore + content + spaceAfter;
}

/**
 * Escapes all potentially dangerous characters, so that the
 * resulting string can be safely inserted into attribute or
 * element text.
 * @param value
 * @returns {string} escaped text
 */
function encodeEntities(value) {
  return value.
    replace(/&amp;/g, &#x27;&amp;amp;&#x27;).
    replace(SURROGATE_PAIR_REGEXP, function(value) {
      var hi = value.charCodeAt(0);
      var low = value.charCodeAt(1);
      return &#x27;&amp;#&#x27; + (((hi - 0xD800) * 0x400) + (low - 0xDC00) + 0x10000) + &#x27;;&#x27;;
    }).
    replace(NON_ALPHANUMERIC_REGEXP, function(value) {
      return &#x27;&amp;#&#x27; + value.charCodeAt(0) + &#x27;;&#x27;;
    }).
    replace(/&lt;/g, &#x27;&amp;lt;&#x27;).
    replace(/&gt;/g, &#x27;&amp;gt;&#x27;);
}

/**
 * create an HTML/XML writer which writes to buffer
 * @param {Array} buf use buf.jain(&#x27;&#x27;) to get out sanitized html string
 * @returns {object} in the form of {
 *     start: function(tag, attrs, unary) {},
 *     end: function(tag) {},
 *     chars: function(text) {},
 *     comment: function(text) {}
 * }
 */
function htmlSanitizeWriter(buf, uriValidator) {
  var ignore = false;
  var out = angular.bind(buf, buf.push);
  return {
    start: function(tag, attrs, unary) {
      tag = angular.lowercase(tag);
      if (!ignore &amp;&amp; specialElements[tag]) {
        ignore = tag;
      }
      if (!ignore &amp;&amp; validElements[tag] === true) {
        out(&#x27;&lt;&#x27;);
        out(tag);
        angular.forEach(attrs, function(value, key) {
          var lkey=angular.lowercase(key);
          var isImage = (tag === &#x27;img&#x27; &amp;&amp; lkey === &#x27;src&#x27;) || (lkey === &#x27;background&#x27;);
          if (validAttrs[lkey] === true &amp;&amp;
            (uriAttrs[lkey] !== true || uriValidator(value, isImage))) {
            out(&#x27; &#x27;);
            out(key);
            out(&#x27;=&quot;&#x27;);
            out(encodeEntities(value));
            out(&#x27;&quot;&#x27;);
          }
        });
        out(unary ? &#x27;/&gt;&#x27; : &#x27;&gt;&#x27;);
      }
    },
    end: function(tag) {
        tag = angular.lowercase(tag);
        if (!ignore &amp;&amp; validElements[tag] === true) {
          out(&#x27;&lt;/&#x27;);
          out(tag);
          out(&#x27;&gt;&#x27;);
        }
        if (tag == ignore) {
          ignore = false;
        }
      },
    chars: function(chars) {
        if (!ignore) {
          out(encodeEntities(chars));
        }
      }
  };
}


// define ngSanitize module and register $sanitize service
angular.module(&#x27;ngSanitize&#x27;, []).provider(&#x27;$sanitize&#x27;, $SanitizeProvider);

/* global sanitizeText: false */

/**
 * @ngdoc filter
 * @name linky
 * @kind function
 *
 * @description
 * Finds links in text input and turns them into html links. Supports http/https/ftp/mailto and
 * plain email address links.
 *
 * Requires the {@link ngSanitize &#x60;ngSanitize&#x60;} module to be installed.
 *
 * @param {string} text Input text.
 * @param {string} target Window (_blank|_self|_parent|_top) or named frame to open links in.
 * @returns {string} Html-linkified text.
 *
 * @usage
   &lt;span ng-bind-html=&quot;linky_expression | linky&quot;&gt;&lt;/span&gt;
 *
 * @example
   &lt;example module=&quot;linkyExample&quot; deps=&quot;angular-sanitize.js&quot;&gt;
     &lt;file name=&quot;index.html&quot;&gt;
       &lt;script&gt;
         angular.module(&#x27;linkyExample&#x27;, [&#x27;ngSanitize&#x27;])
           .controller(&#x27;ExampleController&#x27;, [&#x27;$scope&#x27;, function($scope) {
             $scope.snippet =
               &#x27;Pretty text with some links:\n&#x27;+
               &#x27;http://angularjs.org/,\n&#x27;+
               &#x27;mailto:us@somewhere.org,\n&#x27;+
               &#x27;another@somewhere.org,\n&#x27;+
               &#x27;and one more: ftp://127.0.0.1/.&#x27;;
             $scope.snippetWithTarget = &#x27;http://angularjs.org/&#x27;;
           }]);
       &lt;/script&gt;
       &lt;div ng-controller=&quot;ExampleController&quot;&gt;
       Snippet: &lt;textarea ng-model=&quot;snippet&quot; cols=&quot;60&quot; rows=&quot;3&quot;&gt;&lt;/textarea&gt;
       &lt;table&gt;
         &lt;tr&gt;
           &lt;td&gt;Filter&lt;/td&gt;
           &lt;td&gt;Source&lt;/td&gt;
           &lt;td&gt;Rendered&lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;linky-filter&quot;&gt;
           &lt;td&gt;linky filter&lt;/td&gt;
           &lt;td&gt;
             &lt;pre&gt;&amp;lt;div ng-bind-html=&quot;snippet | linky&quot;&amp;gt;&lt;br&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;
           &lt;/td&gt;
           &lt;td&gt;
             &lt;div ng-bind-html=&quot;snippet | linky&quot;&gt;&lt;/div&gt;
           &lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;linky-target&quot;&gt;
          &lt;td&gt;linky target&lt;/td&gt;
          &lt;td&gt;
            &lt;pre&gt;&amp;lt;div ng-bind-html=&quot;snippetWithTarget | linky:&#x27;_blank&#x27;&quot;&amp;gt;&lt;br&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;
          &lt;/td&gt;
          &lt;td&gt;
            &lt;div ng-bind-html=&quot;snippetWithTarget | linky:&#x27;_blank&#x27;&quot;&gt;&lt;/div&gt;
          &lt;/td&gt;
         &lt;/tr&gt;
         &lt;tr id=&quot;escaped-html&quot;&gt;
           &lt;td&gt;no filter&lt;/td&gt;
           &lt;td&gt;&lt;pre&gt;&amp;lt;div ng-bind=&quot;snippet&quot;&amp;gt;&lt;br&gt;&amp;lt;/div&amp;gt;&lt;/pre&gt;&lt;/td&gt;
           &lt;td&gt;&lt;div ng-bind=&quot;snippet&quot;&gt;&lt;/div&gt;&lt;/td&gt;
         &lt;/tr&gt;
       &lt;/table&gt;
     &lt;/file&gt;
     &lt;file name=&quot;protractor.js&quot; type=&quot;protractor&quot;&gt;
       it(&#x27;should linkify the snippet with urls&#x27;, function() {
         expect(element(by.id(&#x27;linky-filter&#x27;)).element(by.binding(&#x27;snippet | linky&#x27;)).getText()).
             toBe(&#x27;Pretty text with some links: http://angularjs.org/, us@somewhere.org, &#x27; +
                  &#x27;another@somewhere.org, and one more: ftp://127.0.0.1/.&#x27;);
         expect(element.all(by.css(&#x27;#linky-filter a&#x27;)).count()).toEqual(4);
       });

       it(&#x27;should not linkify snippet without the linky filter&#x27;, function() {
         expect(element(by.id(&#x27;escaped-html&#x27;)).element(by.binding(&#x27;snippet&#x27;)).getText()).
             toBe(&#x27;Pretty text with some links: http://angularjs.org/, mailto:us@somewhere.org, &#x27; +
                  &#x27;another@somewhere.org, and one more: ftp://127.0.0.1/.&#x27;);
         expect(element.all(by.css(&#x27;#escaped-html a&#x27;)).count()).toEqual(0);
       });

       it(&#x27;should update&#x27;, function() {
         element(by.model(&#x27;snippet&#x27;)).clear();
         element(by.model(&#x27;snippet&#x27;)).sendKeys(&#x27;new http://link.&#x27;);
         expect(element(by.id(&#x27;linky-filter&#x27;)).element(by.binding(&#x27;snippet | linky&#x27;)).getText()).
             toBe(&#x27;new http://link.&#x27;);
         expect(element.all(by.css(&#x27;#linky-filter a&#x27;)).count()).toEqual(1);
         expect(element(by.id(&#x27;escaped-html&#x27;)).element(by.binding(&#x27;snippet&#x27;)).getText())
             .toBe(&#x27;new http://link.&#x27;);
       });

       it(&#x27;should work with the target property&#x27;, function() {
        expect(element(by.id(&#x27;linky-target&#x27;)).
            element(by.binding(&quot;snippetWithTarget | linky:&#x27;_blank&#x27;&quot;)).getText()).
            toBe(&#x27;http://angularjs.org/&#x27;);
        expect(element(by.css(&#x27;#linky-target a&#x27;)).getAttribute(&#x27;target&#x27;)).toEqual(&#x27;_blank&#x27;);
       });
     &lt;/file&gt;
   &lt;/example&gt;
 */
angular.module(&#x27;ngSanitize&#x27;).filter(&#x27;linky&#x27;, [&#x27;$sanitize&#x27;, function($sanitize) {
  var LINKY_URL_REGEXP =
        /((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}&lt;&gt;&quot;”’]/,
      MAILTO_REGEXP = /^mailto:/;

  return function(text, target) {
    if (!text) return text;
    var match;
    var raw = text;
    var html = [];
    var url;
    var i;
    while ((match = raw.match(LINKY_URL_REGEXP))) {
      // We can not end in these as they are sometimes found at the end of the sentence
      url = match[0];
      // if we did not match ftp/http/www/mailto then assume mailto
      if (!match[2] &amp;&amp; !match[4]) {
        url = (match[3] ? &#x27;http://&#x27; : &#x27;mailto:&#x27;) + url;
      }
      i = match.index;
      addText(raw.substr(0, i));
      addLink(url, match[0].replace(MAILTO_REGEXP, &#x27;&#x27;));
      raw = raw.substring(i + match[0].length);
    }
    addText(raw);
    return $sanitize(html.join(&#x27;&#x27;));

    function addText(text) {
      if (!text) {
        return;
      }
      html.push(sanitizeText(text));
    }

    function addLink(url, text) {
      html.push(&#x27;&lt;a &#x27;);
      if (angular.isDefined(target)) {
        html.push(&#x27;target=&quot;&#x27;,
                  target,
                  &#x27;&quot; &#x27;);
      }
      html.push(&#x27;href=&quot;&#x27;,
                url.replace(/&quot;/g, &#x27;&amp;quot;&#x27;),
                &#x27;&quot;&gt;&#x27;);
      addText(text);
      html.push(&#x27;&lt;/a&gt;&#x27;);
    }
  };
}]);


})(window, window.angular);

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
